# Protocol Documentation
<a name="top"></a>

## Table of Contents

- [Protocol Documentation](#protocol-documentation)
  - [Table of Contents](#table-of-contents)
  - [Data.proto](#dataproto)
    - [CharCardEquSet](#charcardequset)
    - [CharCardSet](#charcardset)
    - [EffectResult](#effectresult)
    - [EffectTiming](#effecttiming)
    - [EffectOption](#effectoption)
    - [GameDataSet](#gamedataset)
    - [SkillSet](#skillset)
    - [SkillCardCond](#skillcardcond)
    - [SignEq](#signeq)
    - [EventCard](#eventcard)
    - [EventCardFunc](#eventcardfunc)
    - [EventCardPos](#eventcardpos)
    - [EventCardType](#eventcardtype)
    - [MovePhaseOpt](#movephaseopt)
    - [PlayerSide](#playerside)
    - [RangeType](#rangetype)
  - [Scalar Value Types](#scalar-value-types)



<a name="Data.proto"></a>
<p align="right"><a href="#top">Top</a></p>

## Data.proto



<a name="ULZProto.CharCardEquSet"></a>

### CharCardEquSet
(for future data struct.)
the Character Card equipment Data Set for dueling game.


| Field  | Type            | Label | Description |
| ------ | --------------- | ----- | ----------- |
| equ_id | [int32](#int32) |       |             |
| hp     | [int32](#int32) |       |             |
| ap     | [int32](#int32) |       |             |
| dp     | [int32](#int32) |       |             |






<a name="ULZProto.CharCardSet"></a>

### CharCardSet
the Character Card Data Set


| Field       | Type                                       | Label    | Description                                              |
| ----------- | ------------------------------------------ | -------- | -------------------------------------------------------- |
| char_id     | [int32](#int32)                            |          | Character Card Id                                        |
| card_id     | [int32](#int32)                            |          | Character Card's Card Set Id                             |
| hp_inst     | [int32](#int32)                            |          | Instant Health Point, value will change during the game  |
| ap_inst     | [int32](#int32)                            |          | Instant Attack Point, value will change during the game  |
| dp_inst     | [int32](#int32)                            |          | Instant Defence Point, value will change during the game |
| hp_orig     | [int32](#int32)                            |          | Original Health Point, only value for reference          |
| ap_orig     | [int32](#int32)                            |          | Original Attack Point, only value for reference          |
| dp_orig     | [int32](#int32)                            |          | Original Defence Point, only value for reference         |
| level       | [int32](#int32)                            |          | Character card level                                     |
| status_inst | [StatusSet](#ULZProto.StatusSet)           | repeated | Instant Status list                                      |
| equ_set     | [CharCardEquSet](#ULZProto.CharCardEquSet) |          | Character equipment set                                  |






<a name="ULZProto.EffectResult"></a>

### EffectResult
Data set of Effect Result Node. 
Effect result node is generated by Character Skill, Status or 

| Field          | Type                                   | Label | Description                                                                              |
| -------------- | -------------------------------------- | ----- | ---------------------------------------------------------------------------------------- |
| tar_card       | [int32](#int32)                        |       | the index number of target character card                                                |
| tar_side       | [PlayerSide](#ULZProto.PlayerSide)     |       | the player side of target character card                                                 |
| trigger_time   | [EffectTiming](#ULZProto.EffectTiming) |       | trigger-time of effect-result-node                                                       |
| end_time       | [EffectTiming](#ULZProto.EffectTiming) |       | end-time of effect-result-node, Cool Down (cd) will remove by 1 after end of this timing |
| ef_option      | [EffectOption](#ULZProto.EffectOption) |       | the trigger calculation type, see also [EffectOption](#ULZProto.EffectOption)            |
| hp             | [int32](#int32)                        |       | value change  of health point during effect calculation                                  |
| ap             | [int32](#int32)                        |       | value change of attack point during effect calculation                                   |
| dp             | [int32](#int32)                        |       | value change  of defence point during effect calculation                                 |
| mp             | [int32](#int32)                        |       | value  of move point during effect calculation                                           |
| disable_move   | [bool](#bool)                          |       | status: disable move                                                                     |
| disable_atk    | [bool](#bool)                          |       | status: disable attack                                                                   |
| disable_def    | [bool](#bool)                          |       | status: disable defence                                                                  |
| disable_draw   | [bool](#bool)                          |       | status: disable drawing [EventCard](#eventcard)                                          |
| disable_change | [bool](#bool)                          |       | status: disable change character (not available in one-vs-one dueling game)              |
| binding_func   | [string](#string)                      |       | custom methods or condition methods                                                      |
| remain_cd      | [int32](#int32)                        |       | remain cool-down                                                                         |
| assign_from    | [string](#string)                      |       | assign from, for debug tracing                                                           |
| skill_id       | [int32](#int32)                        |       | skill id, for debug tracing                                                              |
| status_id      | [int32](#int32)                        |       | status id, for debug tracing                                                             |






<a name="ULZProto.EffectTiming"></a>

### EffectTiming
for EffectNode to counter the timing
| Field       | Type                                       | Label | Description |
| ----------- | ------------------------------------------ | ----- | ----------- |
| event_phase | [EventHookPhase](#ULZProto.EventHookPhase) |       |             |
| hook_type   | [EventHookType](#ULZProto.EventHookType)   |       |             |
| sub_count   | [int32](#int32)                            |       |             |


<a name="ULZProto.EffectOption"></a>

### EffectOption


| Name                 | Number | Description                                                                                                              |
| -------------------- | ------ | ------------------------------------------------------------------------------------------------------------------------ |
| Status_Addition      | 0      | Status_Addition : like &#43;3-Move, by cd to change the &#43;/- value                                                    |
| Instance_Change      | 1      | Instance_Change : like posion, it will -1 to inst_value in CC                                                            |
| Status_FixValue      | 2      | Status_FixVal : like Ex Indomitable Spirit , it will last one blood                                                      |
| Hard_Instance_Change | 3      | Hard_Status_FicValue, Somehow, Some Damage is &#34;whatever card is not current use, but still give the damn damage&#34; |








<a name="ULZProto.GameDataSet"></a>

### GameDataSet
GameDataSet 
    the whole instance game-duel dataset stored in redis.


| Field                | Type                                       | Label    | Description                                         |
| -------------------- | ------------------------------------------ | -------- | --------------------------------------------------- |
| room_key             | [string](#string)                          |          | room_key, see also RoomService/message.proto : Room |
| host_id              | [string](#string)                          |          | host_id, the user-id of host player                 |
| duel_id              | [string](#string)                          |          | dueler_id, the user-id of dueler player             |
| game_turn            | [int32](#int32)                            |          | game_turn, the number of turns in game              |
| host_card_deck       | [CharCardSet](#ULZProto.CharCardSet)       | repeated | host_card_deck, the character card                  |
| duel_card_deck       | [CharCardSet](#ULZProto.CharCardSet)       | repeated | duel_card_deck, the character card                  |
| host_curr_card_key   | [int32](#int32)                            |          | host_curr_card, current on-used char-card           |
| duel_curr_card_key   | [int32](#int32)                            |          | dueler_curr_card, current on-used char-card         |
| host_event_card_deck | [EventCard](#ULZProto.EventCard)           | repeated | host_event_card_deck, the randomed event card list  |
| duel_event_card_deck | [EventCard](#ULZProto.EventCard)           | repeated | duel_event_card_deck, the randomed event card list  |
| range                | [RangeType](#ULZProto.RangeType)           |          | curr_range, the current range                       |
| nvn                  | [int32](#int32)                            |          | nvn, 1vs1 (value:1) or 3vs3 ( value : 3)            |
| first_attack         | [PlayerSide](#ULZProto.PlayerSide)         |          | the first attacker player that in current turn      |
| curr_phase           | [PlayerSide](#ULZProto.PlayerSide)         |          | the current attacker player                         |
| event_phase          | [EventHookPhase](#ULZProto.EventHookPhase) |          | event_phase, the event hook phase                   |
| hook_type            | [EventHookType](#ULZProto.EventHookType)   |          | hook_type, the event hook type                      |
| effect_counter       | [EffectResult](#ULZProto.EffectResult)     | repeated | Effect-result-node list                             |










<a name="ULZProto.SkillSet"></a>

### SkillSet

the skill set dataset, it involves the skill calculation service.

feat : the preset skill function in skill calculation service.

condition : the skill triger condition 

| Field       | Type                                     | Label    | Description                                            |
| ----------- | ---------------------------------------- | -------- | ------------------------------------------------------ |
| id          | [int32](#int32)                          |          | skill id                                               |
| feat_no     | [int32](#int32)                          |          | feat function id (refer to skill interpreting service) |
| pow         | [int32](#int32)                          |          | feat function power value                              |
| cond_string | [string](#string)                        |          | feat condition string, for debug                       |
| cond_card   | [SkillCardCond](#ULZProto.SkillCardCond) | repeated | feat condition struct                                  |
| cond_range  | [RangeType](#ULZProto.RangeType)         | repeated | feat range condition                                   |



<a name="ULZProto.SkillCardCond"></a>

### SkillCardCond
Condition structure for skill set

| Field   | Type                                     | Label | Description           |
| ------- | ---------------------------------------- | ----- | --------------------- |
| type    | [EventCardType](#ULZProto.EventCardType) |       | the event card type   |
| val     | [int32](#int32)                          |       | the value for compare |
| compare | [SignEq](#ULZProto.SignEq)               |       | compare sign          |


<a name="ULZProto.SignEq"></a>

### SignEq
sign equalation enum for skill card cond

| Name    | Number | Description       |
| ------- | ------ | ----------------- |
| EQUAL   | 0      | value equal (==)  |
| GREATER | 1      | value greater (>) |
| LESSER  | 2      | value lesser (<)  |
| ANY     | 3      | any value         |








<a name="ULZProto.EventCard"></a>

### EventCard
the event card that with upper value, upper type, down value and down type

remark : flip over effect is controlled by client side, dataset is not including the isFilpover flaging.

| Field       | Type                                     | Label | Description                                             |
| ----------- | ---------------------------------------- | ----- | ------------------------------------------------------- |
| id          | [int32](#int32)                          |       | the instant id after generated from service             |
| up_option   | [EventCardType](#ULZProto.EventCardType) |       | the upper side card option type                         |
| up_val      | [int32](#int32)                          |       | the upper side card option value                        |
| down_option | [EventCardType](#ULZProto.EventCardType) |       | the down side card option type                          |
| down_val    | [int32](#int32)                          |       | the down side card option value                         |
| position    | [EventCardPos](#ULZProto.EventCardPos)   |       | current position that the event card in game            |
| is_invert   | [bool](#bool)                            |       | invert flag the event card is upside down               |
| func_mount  | [EventCardFunc](#ULZProto.EventCardFunc) |       | (for future usage) the type extra mounted function      |
| mount_val   | [int32](#int32)                          |       | (for future usage) the value for extra mounted function |


<a name="ULZProto.EventCardFunc"></a>

### EventCardFunc
(for future usage) the mounted function type

| Name                | Number | Description                  |
| ------------------- | ------ | ---------------------------- |
| null                | 0      | default: no function mounted |
| occur_chance_event  | 1      | extra draw event             |
| occur_heal_event    | 2      | healing event                |
| occur_cure_event    | 3      | cure event                   |
| occur_quick_event   | 4      |                              |
| occur_curse_event   | 5      |                              |
| occur_chalice_event | 6      |                              |
| occur_poison_event  | 7      |                              |
| occur_damage_event  | 8      |                              |



<a name="ULZProto.EventCardPos"></a>

### EventCardPos
event card position, the enum for defining the position
| Name    | Number | Description                            |
| ------- | ------ | -------------------------------------- |
| BLOCK   | 0      | in the event card deck block           |
| INSIDE  | 1      | in the player's hands after draw phase |
| OUTSIDE | 2      | on the player's on-deck area           |
| DESTROY | 3      | in the card destroy area               |



<a name="ULZProto.EventCardType"></a>

### EventCardType
event card type, the enum for defining the event card type

| Name    | Number | Description                                                                            |
| ------- | ------ | -------------------------------------------------------------------------------------- |
| NULL    | 0      | default value, suppose the upper type is not null, while down type is allow to be null |
| ATTACK  | 1      | attack type in short range                                                             |
| DEFENCE | 2      | defence type in all range                                                              |
| GUN     | 3      | attack type in long & middle range                                                     |
| MOVE    | 4      | move type, move point may increase by this card type                                   |
| STAR    | 5      | special type, some skill conidtion may required                                        |



<a name="ULZProto.MovePhaseOpt"></a>

### MovePhaseOpt
the player option in move phase 

| Name     | Number | Description                                                         |
| -------- | ------ | ------------------------------------------------------------------- |
| NO_MOVE  | 0      | default value, value return when player submit no option to service |
| FORWARD  | 1      | move forward                                                        |
| BACKWARD | 2      | move backward                                                       |
| STAY     | 3      | stay, the current character heal for 1 HP when taking this action   |
| CHANGE   | 4      | change character, only available for 3v3 dual game                  |



<a name="ULZProto.PlayerSide"></a>

### PlayerSide


| Name   | Number | Description |
| ------ | ------ | ----------- |
| HOST   | 0      |             |
| DUELER | 1      |             |



<a name="ULZProto.RangeType"></a>

### RangeType


| Name   | Number | Description |
| ------ | ------ | ----------- |
| SHORT  | 0      |             |
| MIDDLE | 1      |             |
| LONG   | 2      |             |



 

 

 



## Scalar Value Types

| .proto Type                    | Notes                                                                                                                                           | C++    | Java       | Python      | Go      | C#         | PHP            | Ruby                           |
| ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------- | ------ | ---------- | ----------- | ------- | ---------- | -------------- | ------------------------------ |
| <a name="double" /> double     |                                                                                                                                                 | double | double     | float       | float64 | double     | float          | Float                          |
| <a name="float" /> float       |                                                                                                                                                 | float  | float      | float       | float32 | float      | float          | Float                          |
| <a name="int32" /> int32       | Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint32 instead. | int32  | int        | int         | int32   | int        | integer        | Bignum or Fixnum (as required) |
| <a name="int64" /> int64       | Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint64 instead. | int64  | long       | int/long    | int64   | long       | integer/string | Bignum                         |
| <a name="uint32" /> uint32     | Uses variable-length encoding.                                                                                                                  | uint32 | int        | int/long    | uint32  | uint       | integer        | Bignum or Fixnum (as required) |
| <a name="uint64" /> uint64     | Uses variable-length encoding.                                                                                                                  | uint64 | long       | int/long    | uint64  | ulong      | integer/string | Bignum or Fixnum (as required) |
| <a name="sint32" /> sint32     | Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int32s.                            | int32  | int        | int         | int32   | int        | integer        | Bignum or Fixnum (as required) |
| <a name="sint64" /> sint64     | Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int64s.                            | int64  | long       | int/long    | int64   | long       | integer/string | Bignum                         |
| <a name="fixed32" /> fixed32   | Always four bytes. More efficient than uint32 if values are often greater than 2^28.                                                            | uint32 | int        | int         | uint32  | uint       | integer        | Bignum or Fixnum (as required) |
| <a name="fixed64" /> fixed64   | Always eight bytes. More efficient than uint64 if values are often greater than 2^56.                                                           | uint64 | long       | int/long    | uint64  | ulong      | integer/string | Bignum                         |
| <a name="sfixed32" /> sfixed32 | Always four bytes.                                                                                                                              | int32  | int        | int         | int32   | int        | integer        | Bignum or Fixnum (as required) |
| <a name="sfixed64" /> sfixed64 | Always eight bytes.                                                                                                                             | int64  | long       | int/long    | int64   | long       | integer/string | Bignum                         |
| <a name="bool" /> bool         |                                                                                                                                                 | bool   | boolean    | boolean     | bool    | bool       | boolean        | TrueClass/FalseClass           |
| <a name="string" /> string     | A string must always contain UTF-8 encoded or 7-bit ASCII text.                                                                                 | string | String     | str/unicode | string  | string     | string         | String (UTF-8)                 |
| <a name="bytes" /> bytes       | May contain any arbitrary sequence of bytes.                                                                                                    | string | ByteString | str         | []byte  | ByteString | string         | String (ASCII-8BIT)            |

